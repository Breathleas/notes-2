#序列比较


序列比较的几个问题包括

1）找出两个相似序列的差别，如字符的插入、字符的删除和字符替换等——编辑距离问题。

2）两条序列，判断其中的一条序列是否是另一条序列的子序列。这种操作常用于搜索特定的序列模式。

3）判断两条序列中是否有非常相似的子序列。

##1 编辑距离（Edit Distance）

量化两条序列的相似程度有两种方法：一为相似度，它是两条序列的函数，其值越大，表示两条序列越相似；与相似度对应的另一个概念是两条序列之间的距离，距离越大，则两条序列的相似度就越小。

***海明（Hamming）距离***：对于两条长度相等的序列，海明距离等于对应位置字符不同的个数。

使用海明距离度量序列距离不够灵活，因为序列可能具有不同长度；并且同一位置上的字符并不一定是真正的对应关系。为了解决字符插入和删除问题，引入***“编辑操作”（Edit Operation）***的概念，又称***Levenshtein距离***，是指两个字串之间，由一个转成另一个所需的最少编辑操作次数。

用字符“-”代表空位，定义下述字符编辑操作：

- Delete（a，-）  — 从第一条序列删除一个字符，或在第二条序列相应的位置插入空白字符；

- Replace（a，b） — 以第二条序列中的字符b替换第一条序列中的字符a；

- Insert（-，b）   — 在第一条序列插入空位字符，或删除第二条序列中的对应字符b。

(实际应用中还可能存在更复杂的序列操作，例如逆序、取补等。)


###计算编辑距离

给定两个序列a和b，计算两者的编辑距离，即串a最少经过多少步操作变成串b.

首先定义函数——edit(i, j)，表示a[0~i]到b[0~j]的编辑距离。

显然可以有如下动态规划公式：

- 初始化：
	- if i == 0 且 j == 0，edit(i, j) = 0
	- if i == 0 且 j > 0，edit(i, j) = j
	- if i > 0 且j == 0，edit(i, j) = i
- 计算：	if i ≥ 1  且 j ≥ 1 ，edit(i, j) == min{ 
	- edit(i-1, j) + 1, 　　　<font color = "green">delete a[i]</font>
	- edit(i, j-1) + 1, 　　　<font color = "green">delete b[j]</font>
	- edit(i-1, j-1) + f(i, j)  　　　<font color = "green">match/edit a[i]/b[j]</font>}

	当第一个字符串的第i个字符不等于第二个字符串的第j个字符时，f(i, j) = 1；否则，f(i, j) = 0。

##可视化序列相似度（点矩阵）

进行序列比较的一个简单的方法是“矩阵作图法”或“对角线作图”，这种方法是由Gibb首先提出的。将两条待比较的序列分别放在矩阵的两个轴上，一条在X轴上，一条在Y轴上。当对应的行与列的序列字符匹配时，则在矩阵对应的位置作出“点”标记。逐个比较所有的字符对，最终形成点矩阵。

显然，如果两条序列完全相同，则在点矩阵主对角线的位置都有标记；如果两条序列存在相同的子串，则对于每一个相同的子串对，有一条与对角线平行的由标记点所组成的斜线。对于矩阵标记图中非重叠的与对角线平行的斜线，可以组合起来，形成两条序列的一种比对。

如果两条序列中有很多匹配的字符对（例如DNA这种字符数量很少的序列），因而在点矩阵中会形成很多点标记。当对比较长的序列进行比较时，这样的点阵图很快会变得非常复杂和模糊。使用滑动窗口代替一次一个位点的比较是解决这个问题的有效方法。

###ref:

 http://www.lmbe.seu.edu.cn/chenyuan/xsun/bioinfomatics/Web/CharpterThree/3.1.htm

http://www.cnblogs.com/biyeymyhjob/archive/2012/09/28/2707343.html